<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script src="http://code.jquery.com/jquery-latest.min.js"></script>

<style type="text/css">
	#container {
		margin: 0 auto;
		display: flex;
		flex-direction: column;
		justify-content: center;
		align-items: center;
		
		width: 500px;
		height: 700px;
	}
	
	.item-input {
		display: flex;
		flex-direction: column;
		width: 200px;
		height: 40px;
	}
	
	.login-btn {
		width: 200px;
		border-radius: 3px;
		border: 1px solid;
	}
	
</style>
</head>
<body>
	<div id="container">
		<div>
			<h1>회원가입</h1>
		</div>
		<form action="/JspStudy_8452/signup" method="post">
			<div>
				<div class="item-input">
					<label class="item-label">이메일</label> 
					<input type="text" name="email">
				</div>
				<div class="item-input">
					<label class="item-label">이름</label> 
					<input type="text" name="name">
				</div>
				<div class="item-input">
					<label class="item-label">사용자이름</label> 
					<input type="text" name="username">
				</div>
				<div class="item-input">
					<label class="item-label">비밀번호</label> 
					<input type="password" name="password">
				</div>
			</div>
			<button type="submit" class="login-btn">회원가입</button>
		</form>
	</div>
	<script type="text/javascript">
		const itemInputs = document.querySelectorAll(".item-input");
		const usernameInput = itemInputs[2].querySelector("input");
		let usernameCheckFlag = "true";
		
		usernameInput.onblur = () => {
			$.ajax({
				type: "get",
				url: "/JspStudy_8452/signup-username-check",
				data: {
					username: usernameInput.value
				},
				dataType: "text",
				success: function(data) {
					if(data == "true") {
						alert("이미 존재하는 사용자 이름입니다.");
					}else {
						alert("가입 가능한 사용자 이름입니다.");
					}
					alert(data);
				},
				error: function(data) {
					alert("비동기 통신 오류");
				}
			});
		}
	</script>
</body>
</html>